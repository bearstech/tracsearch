<!doctype html>
<html>
    <head>
        <title>Trac Search</title>
        <link rel="stylesheet" href="/components/normalize-css/normalize.css">
        <link rel="stylesheet" href="/static/styles.css">
    </head>
    <body>

        <div id="main">
            <h1 class="alpha">Trac Search</h1>
    <form action="/" method="GET">
        <input type="text" name="q" value="{{q}}"/>
        <div id="facets">
            {% for key in results.facets %}
                <div class="facet">
                    <span class="type">{{key}}</span>
                    {% for term in results.facets[key].terms %}
                    <span class="facet"><span class="term">{{term.term}}</span><span class="count">{{term.count}}</span></span>
                    {% endfor %}
                </div>
            {% endfor %}


    </div>
    </form>
    {% if results %}
    <div id="result">Results: {{ results.hits.total }}</div>
     {% for result in results.hits.hits %}
     <div class="response">
         {% if result._type == 'ticket' %}
         <div class="header">
         <span class="serial">#{{result._id}}</span>
         <span class="title">{{ result._source.summary}}</span>
         <span class="status">{{ result._source.status }}</span>
         <span class="reporter">{{ result._source.reporter }}</span>
         <span class="changetime">{{ result._source.changetime }}</span>
     </div>
         <dl class="lining">
         {% for field in result['highlight'] %}
            <dt>{{field}}</dt>
            {% for value in result['highlight'][field] %}
                <dd>…{{value | safe}}…</dd>
            {% endfor%}
         {% endfor %}
         </dl>
         {% endif %}
     </div>

 {% endfor %}

 {% endif %}
 </div>
    </body>
</html>
